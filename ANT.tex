\chapter{代数数论}

\section{引子}
Fermat 对不定方程的研究，可谓代数数论之滥觞.  在讨论「数域」、「素理想」、「Abel 扩张」之类的抽象概念之前，我们将沿着 Fermat 的脚步，考察一些具体的不定方程，来体会这些抽象概念对解决经典意义上的“数论”问题的帮助.

\begin{question}
  对给定的 $n$, 求 $n = x^2 + y^2$ 的整数解.
\end{question}


如果等号的右边是 $x^2 - y^2 = (x+y)(x-y)$, 这个问题是平凡的：只需将 $n$ 写成 $n = d_1d_2$ 的形式，若 $d_1$ 与 $d_2$ 同奇偶，我们就得到了一组 $(x, y)$; 且所有的解都能如此得到.

但是 $x^2 + y^2$ 并不能进一步因式分解.  {\kaishu 真的如此吗？}  我们不妨将眼界拓宽些：$x^2 + y^2 = (x+iy)(x-iy)$.

若 $m = x_1^2 + y_1^2$, $n = x_2^2 + y_2^2$, 则 $mn = (x_1x_2-y_1y_2 + i(x_1y_2+x_2y_1))(x_1x_2-y_1y_2 - i(x_1y_2+x_2y_1)) = (x_1x_2-y_1y_2)^2 + (x_1y_2+x_2y_1)^2$.  从而只要方程对 $m$, $n$ 的解，就能构造出对 $mn$ 的解.  因此只需考虑左端是素数 $p$ 的情况.  进行一些简单的试验即可发现，$p = 1 \pmod 4$ 时总是有唯一解，而 $p = 3 \pmod 4$ 时总是无解.

回头观察 $p = (x+iy)(x-iy)$.  这可以视为在 $\Z[i] := \{x+iy : x, y \in \Z$ 中的素因数分解.  于是问题转化为：什么情况下 $p$ 在 $B = \Z[i]$ 中仍是“素数”，什么情况下 $p$ 可以进一步分解？运用一些抽象代数的知识，考虑环 $\Z[x]$.  若先模去主理想 $(x^2+1)$ 再模去 $(p)$ 可得 $\bar B = \Z[i]/(p)$.  若先模去 $(p)$ 再模去 $(x^2+1)$ 则得到 $\bar B' = \F_p[x]/(x^2+1)$.  稍加考虑即可得知 $\bar B = \bar B'$, 并且有如下对应关系：

\begin{table}[h]
  \begin{tabular}{llll}
    $(p)$ 在 $\Z[i]$ 中是素理想 & $\bar B$ 是整环 & $\bar B'$ 是整环 & $(x^2+1)$ 在 $\F_p$ 上不可约 \\
    $(p)$ 在 $\Z[i]$ 中分解为相异素理想的乘积 & $\bar B$ 有零因子 & $\bar B'$ 有零因子 & $(x^2+1)$ 在 $\F_p$ 中有相异根 \\
    $(p)$ 在 $\Z[i]$ 中的分解含有某素理想的幂 & $\bar B$ 有幂零元 & $\bar B'$ 有幂零元 & $(x^2+1)$ 在 $\F_p$ 中有重根
  \end{tabular}
\end{table}

关于 $x^2+1$ 在 $\F_p$ 中解的情况，二次互反律\footnotemark{}已经为我们提供了解答——正好与我们的观察相符.  另外 $x^2+1$ 有重根当且仅当 $\Delta = -4 = 0 \pmod p$, 即 $p = 2$.  事实上在 $\Z[i]$ 中成立 $(2) = (1+i)^2$.

\footnotetext{或者注意到 $x^2+1$ 的根恰是 $\F_p^\times$ 中的 $4$ 阶元，又由 $\F_p^\times$ 是循环群可知这样的元素存在当且仅当 $p = 1 \pmod 4$.}

至此，问题已经解决了.  {\kaishu 真的如此吗？}  并不！前面的论述都只在「理想」的层面进行，而 $p = (x+iy)(x-iy)$ 的解是在「元素」层面考虑的.  因此我们还需要考虑「理想」与「元素」间的差异.  并非所有元素都能生成真理想：单位元（可逆元）生成整个环.  另外理想也未必由单个元素生成.  我们需要考虑 $\Z[i]$ 中理想的结构，并考虑其中的单位元的影响，才算是完成了对原方程解的分析.  我们有如下事实：
\begin{fact}
  $\Z[i]$ 是主理想整环.
\end{fact}
\begin{fact}
  $\Z[i]$ 中的单位元仅有 $\{\pm 1, \pm i\}$.
\end{fact}

这两个事实在一般数域中的推广以「理想类群」和「单位群」的概念来表达.  关于这两个群的重要结果——类数有限定理和 Dirichlet 单位定理——是代数数论中最重要的定理.  而关于理想分解的一般理论，则是类域论所要解决的主要问题.

\section{数域}
\begin{defn}
  $\Q$ 的有限扩张称为\emph{数域}.  若 $K$ 是数域，则 $\Z$ 在其中的整闭包称为 $K$ 的整数环，以 $O_K$ 表示.  $O_K$ 中的理想也常称为 $K$ 中的理想.
\end{defn}
对于数域中的理想，我们有唯一分解定理.
\begin{thm}
  $O_K$ 为 Dedekind 整环.
\end{thm}
\begin{proof}
  TBW
\end{proof}
为了定义理想类群，我们需要考虑“带分母的理想”：
\begin{defn}
  令 $R$ 为整环，$K$ 为其分式域.  设 $I$ 为 $K$ 作为 $R$-模的子模.  若存在 $r \in R$ 使得 $rI \subseteq R$, 则称 $I$ 为 $R$ 的\emph{分式理想}.
\end{defn}
与（整）理想不同，分式理想关于理想的乘法形成群.
\begin{lemma}
  若 $R$ 为 Dedekind 整环，$I$ 为其分式理想，则存在分式理想 $J$ 使得 $IJ = R$.
\end{lemma}
\begin{proof}
  设 $rI$ 为整理想，则由 Dedekind 整环中理想的唯一分解定理可设 $rI = p_1^{s_1} \ldots p_n^{s_n}$.  任取 $a \in rI$, 并设 $(a) = p_1^{t_1} \ldots p_n^{t_n}$, 不难看出 $t_i \ge s_i$.  令 $J = a^{-1} (p_1^{t_1-s_1} \ldots p_n^{t_n-s^n})$, 则 $IJ = R$.
\end{proof}
\begin{prop}
  若 $R$ 为 Dedekind 整环，则 $R$ 的全体分式理想关于理想的乘法形成群，记为 $\I(R)$.  其单位元为 $R$.
\end{prop}
对数域 $K$, $K^\times$ 到 $\I(O_K)$ 有自然映射 $a \mapsto (a)$.  此映射越接近同构，“元素”层面的唯一分解定理就越接近成立.  因此要考虑其核及余核.
\begin{defn}
  对数域 $K$, $O_K^\times$ 称为 $K$ 的\emph{单位群}.  $\I(O_K) / K^\times$ 称为 $K$ 的\emph{理想类群}, 记为 $\Cl(K)$.
\end{defn}

本章的目标即为证明如下两个定理：
\begin{thm}
  设 $K$ 为数域，则 $\Cl(K)$ 为有限群.
\end{thm}
\begin{thm}[Dirichlet 单位定理]
  设 $K$ 为数域，$K$ 到 $\R$ 有 $r_1$ 个嵌入，$K$ 到 $\C$ 有 $2r_2$ 个嵌入.  则 $O_K^\times \cong \Z^{r_1+r_2-1} \oplus \mu^\times$, 其中 $\mu^\times$ 为 $O_K$ 中的单位根所形成的群.
\end{thm}

\section{局部域}
\begin{defn}
  设 $F$ 为域，$F$ 上的\emph{赋值}是一个映射 $v \colon F \to \R \cup \{+\infty\}$ 使得
  \begin{enumerate}
  \item $v(x) = +\infty \Leftrightarrow x = 0$.
  \item $v(xy) = v(x) + v(y)$.
  \item $v(x+y) \ge \min \{v(x), v(y)\}$.
  \end{enumerate}
\end{defn}

\begin{thm}[Hensel 引理]
  设 $F$ 为完备赋值域，$f \in O_F[X]$, $\bar f = f_1 f_2$, 其中 $f_1$, $f_2 \in \bar F[X]$ 互素.  则存在 $g$, $h \in O_F[X]$ 使得 $f = gh$, $\bar g = f_1$, $\bar h = f_2$, 且 $\deg g = \deg f_1$.
\end{thm}

Hensel 引理的重要性在于，它将较难把握的 $F$ 中的多项式分解问题归结为 $\bar F$ 中的多项式分解问题.  对于 $p$-进域，$\bar F$ 是有限域，因此其中的多项式分解是易于把握的.

作为 Hensel 引理的用例，我们可以确定 $p > 2$ 时 $\Q_p$ 中平方元的形式.  设 $a = p^n u \in \Q_p$, 其中 $n = v_p(a)$, $u \in \Z_p^\times$.  不难证明 $a$ 为平方元当且仅当 $n$ 为偶数且 $u$ 为 $\Z_p$ 中的平方元.  考虑 $X^2 - u \in \Z_p[X]$, 它能分解为两个一次多项式的乘积当且仅当 $u$ 为平方元，而由 Hensel 引理，这又等价于 $X^2 - \bar u \in \F_p[X]$ 能分解，即 $\bar u$ 为二次剩余.  不难由此看出，$\Q_p / \Q_p^2 = \Z/2\Z \times \Z/2\Z$.
